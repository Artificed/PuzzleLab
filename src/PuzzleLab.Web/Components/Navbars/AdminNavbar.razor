@using PuzzleLab.Web.Services.State
@inject NavigationManager NavigationManager
@inject UserStateService UserState

<div class="flex justify-between items-center border-gray-200">
    <div class="flex items-center justify-center gap-16">
        <a href="/admin/dashboard" class="text-xl font-bold text-gray-800">PuzzleLab Admin</a>
        <div class="flex items-center gap-4">
            <a href="/admin/dashboard"
               class="inline-flex items-center justify-center whitespace-nowrap text-md focus-visible:ring-gray-950 focus-visible:ring-offset-1 h-10 px-4 py-2 @(IsActive("/admin/dashboard") ? "font-medium text-gray-900 underline" : "text-gray-600 hover:text-gray-900")">
                Dashboard
            </a>
            <a href="/admin/question-packages"
               class="inline-flex items-center justify-center whitespace-nowrap text-md focus-visible:ring-gray-950 focus-visible:ring-offset-1 h-10 px-4 py-2 @(IsActive("/admin/question-packages") ? "font-medium text-gray-900 underline" : "text-gray-600 hover:text-gray-900")">
                Manage Packages
            </a>
            <a href="/admin/quizzes"
               class="inline-flex items-center justify-center whitespace-nowrap text-md focus-visible:ring-gray-950 focus-visible:ring-offset-1 h-10 px-4 py-2 @(IsActive("/admin/quizzes") ? "font-medium text-gray-900 underline" : "text-gray-600 hover:text-gray-900")">
                Manage Quizzes
            </a>
            <a href="/admin/users"
               class="inline-flex items-center justify-center whitespace-nowrap text-md focus-visible:ring-gray-950 focus-visible:ring-offset-1 h-10 px-4 py-2 @(IsActive("/admin/users") ? "font-medium text-gray-900 underline" : "text-gray-600 hover:text-gray-900")">
                Manage Users
            </a>
            <a href="/admin/schedules"
               class="inline-flex items-center justify-center whitespace-nowrap text-md focus-visible:ring-gray-950 focus-visible:ring-offset-1 h-10 px-4 py-2 @(IsActive("/admin/schedules") ? "font-medium text-gray-900 underline" : "text-gray-600 hover:text-gray-900")">
                View Schedules
            </a>
            <a href="/admin/results"
               class="inline-flex items-center justify-center whitespace-nowrap text-md focus-visible:ring-gray-950 focus-visible:ring-offset-1 h-10 px-4 py-2 @(IsActive("/admin/results") ? "font-medium text-gray-900 underline" : "text-gray-600 hover:text-gray-900")">
                View Results
            </a>
        </div>
    </div>

    <div class="flex items-center space-x-4">
        <span class="text-sm text-gray-600">Admin</span>
        <button @onclick="HandleLogout" class="text-sm text-red-600 hover:text-red-800">Logout</button>
    </div>
</div>

@code {
    [Parameter] public EventCallback HandleLogout { get; set; }

    private bool IsActive(string href)
    {
        var relativePath = NavigationManager.ToBaseRelativePath(NavigationManager.Uri).Split('?')[0];
        var normalizedHref = href.TrimStart('/');

        if (string.IsNullOrEmpty(relativePath) || relativePath.Equals("admin", StringComparison.OrdinalIgnoreCase))
        {
            return normalizedHref.Equals("admin/dashboard", StringComparison.OrdinalIgnoreCase);
        }

        return relativePath.Equals(normalizedHref, StringComparison.OrdinalIgnoreCase) ||
               relativePath.StartsWith(normalizedHref + "/", StringComparison.OrdinalIgnoreCase);
    }
}